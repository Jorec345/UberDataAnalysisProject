count()%>%
arrange(desc("No.ofOrders" = n))
ggplot(EmployeeYearlyExpense,aes(fill = FullNames,x = FullNames,y = n))+
geom_histogram(position = "dodge",stat = "identity")+
facet_grid(.~Year)+
ggtitle("Frequency of Uber orders")
ggplot(EmployeeYearlyExpense,aes(fill = FullNames,x = FullNames,y = n))+
geom_histogram(position = "dodge",stat = "identity")+
facet_wrap(.~Year)+
ggtitle("Frequency of Uber orders")
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames, Year)%>%
summarise(Individual_Charges = sum(Charges))%>%
arrange(desc())
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames, Year)%>%
summarise(Individual_Charges = sum(Charges))%>%
sort(decreasing = TRUE)
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames, Year)%>%
summarise(Individual_Charges = sum(Charges))
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames, Year)%>%
summarise(Individual_Charges = sum(Charges))%>%
sort()
EmployeeYearlyExpense <-
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames,Year)%>%
summarise(Individual_Charges = sum(Charges))
EmployeeYearlyExpense
##individual employee total orders
EmployeeYearlyExpense <-
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames, Year)%>%
count()%>%
arrange(desc("No.ofOrders" = n))
EmployeeYearlyExpense
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames,Year)%>%
summarise(Individual_Charges = sum(Charges))%>%
arrange(desc(Individual_Charges))
##individual employee expenses
EmployeeYearlyExpense <-
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames,Year)%>%
summarise(Individual_Charges = sum(Charges))%>%
arrange(desc(Individual_Charges))
##Employee analysis by time of order and amount paid
Order_Amount <-
New.UberData%>%
select(Charges,hours)
Order_Amount
###analysis by time of order
colnames(New.UberData)
New.UberData%>%
group_by(hours)
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(hours)
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(hours)%>%
summarise(No.OfOrders = n()) %>%
arrange(desc(No.OfOrders))
UberData%>%
mutate(Duration = as.numeric(Duration..min.),
GST = as.numeric(GST.amount),
datetime = paste(Request.Date..Local.,Request.Time..Local.),
"Request Time" = strptime(datetime, format = "%m/%d/%Y %H:%M"),
"Date Requested" = as.IDate(`Request Time`),
dayofweek = weekdays(`Date Requested`),
"Time Requested" = format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H:%M"),
hours = as.numeric(format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H")),
Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))
UberData%>%
mutate(Duration = as.numeric(Duration..min.),
GST = as.numeric(GST.amount),
datetime = paste(Request.Date..Local.,Request.Time..Local.),
"Request Time" = strptime(datetime, format = "%m/%d/%Y %H:%M"),
"Date Requested" = as.IDate(`Request Time`),
dayofweek = weekdays(`Date Requested`),
"Time Requested" = format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H:%M"),
hours = as.numeric(format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H")),
Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))
UberData%>%
mutate(Duration = as.numeric(Duration..min.),
GST = as.numeric(GST.amount),
datetime = paste(Request.Date..Local.,Request.Time..Local.),
"Request Time" = strptime(datetime, format = "%m/%d/%Y %H:%M"),
"Date Requested" = as.IDate(`Request Time`),
dayofweek = weekdays(`Date Requested`),
"Time Requested" = format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H:%M"),
hours = as.numeric(format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H")),
Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First.Name`,`Last.Name`))
UberData%>%
mutate(Duration = as.numeric(Duration..min.),
GST = as.numeric(GST.amount),
datetime = paste(Request.Date..Local.,Request.Time..Local.),
"Request Time" = strptime(datetime, format = "%m/%d/%Y %H:%M"),
"Date Requested" = as.IDate(`Request Time`),
dayofweek = weekdays(`Date Requested`),
"Time Requested" = format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H:%M"),
hours = as.numeric(format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H")),
Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First.Name`,`Last.Name`))%>%
select(-c(1,2,9,10,20,21))%>%
rename("Employee ID" = Employee.ID,
"Distance" = Distance..mi.,
"Service and Tech Fees"= Service.and.Technology.Fee,
"Dropoff Address"= Dropoff.Address,
"Pickup Address" = Pickup.Address,
"Expense Code"= Expense.Code,
"Expense Memo"= Expense.Memo,
"Fare" = Fare.in.KES,
"Charges" = Total.Charge.in.KES)
##individual employee expenses
EmployeeYearlyExpense <-
New.UberData%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames,Year)%>%
summarise(Individual_Charges = sum(Charges))%>%
arrange(desc(Individual_Charges))
##cleaning and processing the Data my data
New.UberData <-
UberData%>%
mutate(Duration = as.numeric(Duration..min.),
GST = as.numeric(GST.amount),
datetime = paste(Request.Date..Local.,Request.Time..Local.),
"Request Time" = strptime(datetime, format = "%m/%d/%Y %H:%M"),
"Date Requested" = as.IDate(`Request Time`),
dayofweek = weekdays(`Date Requested`),
"Time Requested" = format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H:%M"),
hours = as.numeric(format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H")),
Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name))%>%
select(-c(1,2,9,10,20,21))%>%
rename("First Name" = First.Name,
"Last Name" = Last.Name,
"Employee ID" = Employee.ID,
"Distance" = Distance..mi.,
"Service and Tech Fees"= Service.and.Technology.Fee,
"Dropoff Address"= Dropoff.Address,
"Pickup Address" = Pickup.Address,
"Expense Code"= Expense.Code,
"Expense Memo"= Expense.Memo,
"Fare" = Fare.in.KES,
"Charges" = Total.Charge.in.KES)
##individual employee total orders
EmployeeYearlyExpense <-
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames, Year)%>%
count()%>%
arrange(desc())
New.UberData <-
UberData%>%
mutate(Duration = as.numeric(Duration..min.),
GST = as.numeric(GST.amount),
datetime = paste(Request.Date..Local.,Request.Time..Local.),
"Request Time" = strptime(datetime, format = "%m/%d/%Y %H:%M"),
"Date Requested" = as.IDate(`Request Time`),
dayofweek = weekdays(`Date Requested`),
"Time Requested" = format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H:%M"),
hours = as.numeric(format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H")),
Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name))%>%
select(-c(1,2,9,10,20,21))%>%
rename("First Name" = First.Name,
"Last Name" = Last.Name,
"Employee ID" = Employee.ID,
"Distance" = Distance..mi.,
"Service and Tech Fees"= Service.and.Technology.Fee,
"Dropoff Address"= Dropoff.Address,
"Pickup Address" = Pickup.Address,
"Expense Code"= Expense.Code,
"Expense Memo"= Expense.Memo,
"Fare" = Fare.in.KES,
"Charges" = Total.Charge.in.KES)
##handling missing values by replacing them with 0
New.UberData$GST[which(is.na(New.UberData$GST))] <- 0
##Exploratory Data Analysis
##analysis by year
YearlyData <-
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")))%>%
select(Charges,Months,Year)%>%
group_by(Year)%>%
summarise(summedTotals = sum(Charges))
###analysis of expenditure trends by months
MonthlyData <-
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name))%>%
select(Charges,Months,Year)%>%
group_by(Months, Year)%>%
summarise(MonthlyTotals = sum(Charges))
##Employee STATS Analysis
##Total Number of employee uber orders by Months
EmployeeMonthlyFreq <-
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,12,17,19,20,21,22)%>%
group_by(Months,Year)%>%
count()%>%
rename(Freq = n)
##individual employee total orders
EmployeeYearlyExpense <-
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames, Year)%>%
count()%>%
arrange(desc())
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames, Year)
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames,Year)
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames,Year)%>%
count()
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames,Year)%>%
count()%>%
arrange(desc(n))
##individual employee total orders
EmployeeYearlyExpense <-
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames,Year)%>%
count()%>%
arrange(desc(n))
EmployeeYearlyExpense <-
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name),
FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(FullNames,Year)%>%
summarise(Individual_Charges = sum(Charges))%>%
arrange(desc(Individual_Charges))
New.UberData%>%
mutate(FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)
New.UberData%>%
mutate(FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(hours)
New.UberData%>%
mutate(FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(hours)%>%
summarise(No.OfOrders = n())
New.UberData%>%
mutate(FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(hours)%>%
summarise(No.OfOrders = n()) %>%
arrange(desc(No.OfOrders))
###analysis by time of order
AnalysisByTime <-
New.UberData%>%
mutate(FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(hours)%>%
summarise(No.OfOrders = n()) %>%
arrange(desc(No.OfOrders))
ggplot(EmployeeMonthlyFreq,aes(fill = hours,x = hours,y = No.OfOrders))+
geom_histogram(position = "dodge",stat = "identity")+
ggtitle("Analysis by time of order")
ggplot(data = AnalysisByTime, aes(x = hours, y = No.OfOrders))+
geom_bar(stat = 'identity', aes(fill = hours))+
ggtitle("Analysis by time of order")
##evaluating correlation between distance,Fare and Duration
## Our hypothesis - they are correlated
Data.f <-
New.UberData%>%
select(hours,Fare)
cor(Data.f)
New.UberData
New.UberData%>%
mutate(FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(hours,dayofweek)%>%
summarise(No.OfOrders = n()) %>%
arrange(desc(No.OfOrders))
New.UberData%>%
mutate(FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
filter(Year == "2017")
group_by(dayofweek)%>%
summarise(No.OfOrders = n()) %>%
arrange(desc(No.OfOrders))
New.UberData%>%
mutate(FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
filter(Year == "2017")%>%
group_by(dayofweek)%>%
summarise(No.OfOrders = n()) %>%
arrange(desc(No.OfOrders))
New.UberData%>%
mutate(FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
filter(Year == "2018")%>%
group_by(dayofweek)%>%
summarise(No.OfOrders = n()) %>%
arrange(desc(No.OfOrders))
New.UberData%>%
mutate(FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(dayofweek,Year)%>%
summarise(No.OfOrders = n()) %>%
arrange(desc(No.OfOrders))
New.UberData%>%
mutate(FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
filter(Year == "2018")%>%
group_by(dayofweek)%>%
summarise(No.OfOrders = n()) %>%
arrange(desc(No.OfOrders))
###analysis by time of order
AnalysisByTime <-
New.UberData%>%
mutate(FullNames = paste(`First Name`,`Last Name`))%>%
select(9,10,13,12,17,19,20,21,22)%>%
group_by(hours)%>%
summarise(No.OfOrders = n()) %>%
arrange(desc(No.OfOrders))
##Visualizing analysis by time of order using a bar chart
ggplot(data = AnalysisByTime, aes(x = hours, y = No.OfOrders))+
geom_bar(stat = 'identity', aes(fill = hours))+
ggtitle("Analysis by time of order")
##Visualization using pie charts
pie(YearlyData$summedTotals,labels = YearlyData$Year,
main = "Yearly Expenditure on Uber", col = c("red","blue"))
##barplot visualization
barplot(YearlyData$summedTotals, main = "Yearly Expenditure on Uber", ylab = "summedTotals",
xlab = "Year", horiz = F,
col = c("red","Blue")
,border = "green")
##Visualization using pie charts
pie(YearlyData$summedTotals,labels = YearlyData$Year,
main = "Yearly Expenditure on Uber", col = c("red","blue"))
##Visualization using pie charts
pie(YearlyData$summedTotals,labels = YearlyData$Year,
main = "Yearly Expenditure on Uber", col = c("red","blue"))
library(dplyr)
library(readr)
library(stats)
library(chron)
library(tidyverse)
library(data.table)
library(hrbrthemes)
library(tidyr)
library(viridis)
library(ggpubr)
library(psych)
library(lubridate)
##consuming in the 2018 Data
UberData <- read.csv("UberData.csv",header = TRUE, stringsAsFactors = FALSE)
##cleaning and processing the Data my data
New.UberData <-
UberData%>%
mutate(Duration = as.numeric(Duration..min.),
GST = as.numeric(GST.amount),
datetime = paste(Request.Date..Local.,Request.Time..Local.),
"Request Time" = strptime(datetime, format = "%m/%d/%Y %H:%M"),
"Date Requested" = as.IDate(`Request Time`),
dayofweek = weekdays(`Date Requested`),
"Time Requested" = format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H:%M"),
hours = as.numeric(format(strptime(`Request.Time..Local.`,"%I:%M %p"),
format = "%H")),
Year = as.numeric(format(`Date Requested`, "%Y")),
Months = factor(months(as.Date(`Date Requested`)),
levels = month.name))%>%
select(-c(1,2,9,10,20,21))%>%
rename("First Name" = First.Name,
"Last Name" = Last.Name,
"Employee ID" = Employee.ID,
"Distance" = Distance..mi.,
"Service and Tech Fees"= Service.and.Technology.Fee,
"Dropoff Address"= Dropoff.Address,
"Pickup Address" = Pickup.Address,
"Expense Code"= Expense.Code,
"Expense Memo"= Expense.Memo,
"Fare" = Fare.in.KES,
"Charges" = Total.Charge.in.KES)
##handling missing values by replacing them with 0
New.UberData$GST[which(is.na(New.UberData$GST))] <- 0
##Exploratory Data Analysis
##analysis by year
YearlyData <-
New.UberData%>%
mutate(Year = as.numeric(format(`Date Requested`, "%Y")))%>%
select(Charges,Months,Year)%>%
group_by(Year)%>%
summarise(summedTotals = sum(Charges))
